// test my applet
establish_context
enable_trace
enable_timer
card_connect

// create
send_apdu -sc 0 -APCU 80B800001007012345678906070700000431323334

// select
send_apdu -sc 0 -APDU 00A40400080102030405060809

// -------------------------------------------------------------------------------------
// -----------------------------------GENERALS------------------------------------------
//  WRONG instruction                   ->0x6d00
send_apdu -sc 0 -APCU 8001000007

//  WRONG CLA                           ->0x6e00
send_apdu -sc 0 -APCU 0000000007

// -------------------------------------------------------------------------------------
// ----------------------------NON VERIFIED ACCESS--------------------------------------
//  OK  Name       ->46454e4f4d454e9000
send_apdu -sc 0 -APCU 8000000007

//  WRONG set data len = 2       ->0x6301
send_apdu -sc 0 -APCU 80020000022222

//  WRONG get data len = 2       ->0x6301
send_apdu -sc 0 -APCU 8002000002


//  WRONG encrypt                ->0x6301
send_apdu -sc 0 -APCU 8042000010000102030405060708090a0b0c0d0e0f


//  WRONG decrypt                ->0x6301
send_apdu -sc 0 -APCU 8044000020bbe3bfeda6fef47711153d8c32f4a1c839c2facc36dfe098ea9875060aa22f6e


// -------------------------------------------------------------------------------------
// ---------------------------------VERIFICATION----------------------------------------
//  WRONG PIN                   ->0x6300
send_apdu -sc 0 -APCU 802000000400000000

//  WRONG PIN                   ->0x6300
send_apdu -sc 0 -APCU 802000000401020304

//  OK  PIN                     ->0x9000
send_apdu -sc 0 -APCU 802000000431323334

// -------------------------------------------------------------------------------------
// ------------------------------------NAME---------------------------------------------
//  OK          ->46454e4f4d454e9000
send_apdu -sc 0 -APCU 8000000007

//  Want more   ->46454e4f4d454e9000
send_apdu -sc 0 -APCU 800000000a

//  Want less   ->46459000
send_apdu -sc 0 -APCU 8000000002

// -------------------------------------------------------------------------------------
// ---------------------------------SET-DATA--------------------------------------------

//  OK              len = 20            ->0x9000
send_apdu -sc 0 -APCU 80020000140001020304000102030400010203040001020304

//  WRONG           len = 21             ->0x6700
send_apdu -sc 0 -APCU 8002000015000102030400010203040001020304000102030400

// -------------------------------------------------------------------------------------
// ---------------------------------GET-DATA--------------------------------------------
//  OK          len = 20             ->0x9000
send_apdu -sc 0 -APCU 8004000014

//  WRONG       len = 7              ->0x6c14
send_apdu -sc 0 -APCU 8004000007

//  WRONG       len = 21             ->0x6c14
send_apdu -sc 0 -APCU 8004000015

//  OK  set     len = 2              ->0x9000
send_apdu -sc 0 -APCU 80020000022222

//  WRONG       len = 3              ->0x6c02
send_apdu -sc 0 -APCU 8004000003

//  OK          len = 2              ->0x9000
send_apdu -sc 0 -APCU 8004000002

// -------------------------------------------------------------------------------------
// ---------------------------------ENCRYPT---------------------------------------------

//  OK          len = 16             ->0x9000
send_apdu -sc 0 -APCU 8042000010000102030405060708090a0b0c0d0e0f


//  OK          len = 64             ->0x9000
send_apdu -sc 0 -APCU 8042000040000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f

//  WRONG       len = 15          ->0x6700
send_apdu -sc 0 -APCU 804200000f000102030405060708090a0b0c0d0e

//  WRONG       len = 65          ->0x6700
send_apdu -sc 0 -APCU 8042000041000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f00

//  WRONG       len = 37          ->0x6700
send_apdu -sc 0 -APCU 8042000025000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f0001020304

// -------------------------------------------------------------------------------------
// ---------------------------------DECRYPT---------------------------------------------

//  OK          len = 32          ->0x9000
send_apdu -sc 0 -APCU 8044000020bbe3bfeda6fef47711153d8c32f4a1c839c2facc36dfe098ea9875060aa22f6e

// OK           len = 80          ->0x9000
send_apdu -sc 0 -APCU 8044000050 ...

// WRONG mac    len = 32          ->0x6a80
send_apdu -sc 0 -APCU 8044000020bbe3bfeda6fef47711153d8c32f4a1c8ffffffffffffffffffffffffffffffff

//  WRONG       len = 16          ->0x6700
send_apdu -sc 0 -APCU 8042000010000102030405060708090a0b0c0d0e0f

//  WRONG       len = 31          ->0x6700
send_apdu -sc 0 -APCU 804200000f000102030405060708090a0b0c0d0e

//  WRONG       len = 81          ->0x6700
send_apdu -sc 0 -APCU 8042000051000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f00

//  WRONG       len = 37          ->0x6700
send_apdu -sc 0 -APCU 8042000025000102030405060708090a0b0c0d0e0f000102030405060708090a0b0c0d0e0f0001020304

// -------------------------------------------------------------------------------------
// --------------------------------BLOCK APPLET-----------------------------------------
// 3.attempt wrong PIN            ->0x6300
send_apdu -sc 0 -APCU 802000000469696969

//  4.attempt correct pin - not select applet  ->6999
send_apdu -sc 0 -APCU 802000000431323334

//  WRONG  Name                   ->0x6999
send_apdu -sc 0 -APCU 8000000007



card_disconnect
release_context

